<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The FDE — Live Pipeline</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/static/dashboard.css">
</head>
<body>
    <div class="dashboard">
        <!-- Header -->
        <header class="header">
            <div class="header-left">
                <div class="logo">
                    <svg width="28" height="28" viewBox="0 0 28 28" fill="none">
                        <rect width="28" height="28" rx="8" fill="#2563EB"/>
                        <path d="M7 9h14M7 14h10M7 19h12" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                    <span class="logo-text">The FDE</span>
                </div>
                <span class="header-divider"></span>
                <span class="header-subtitle">Live Pipeline</span>
            </div>
            <div class="header-controls">
                <div class="live-badge" id="live-badge">
                    <div class="live-dot"></div>
                    <span class="live-text">Connecting</span>
                </div>
                <button class="btn btn-start" id="btn-start" onclick="startDemo()">
                    <svg width="14" height="14" viewBox="0 0 14 14" fill="none">
                        <path d="M3 1.5L12 7L3 12.5V1.5Z" fill="currentColor"/>
                    </svg>
                    Run Pipeline
                </button>
            </div>
        </header>

        <!-- Pipeline Steps -->
        <div class="pipeline">
            <div class="pipeline-track">
                <div class="pipeline-step">
                    <div class="step-circle" id="step-scrape">
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                            <path d="M2 3h12M2 8h8M2 13h10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                        </svg>
                    </div>
                    <span class="step-label">Scrape</span>
                </div>
                <div class="pipeline-connector"></div>
                <div class="pipeline-step">
                    <div class="step-circle" id="step-analyze">
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                            <circle cx="7" cy="7" r="5" stroke="currentColor" stroke-width="1.5"/>
                            <path d="M11 11l3 3" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                        </svg>
                    </div>
                    <span class="step-label">Analyze</span>
                </div>
                <div class="pipeline-connector"></div>
                <div class="pipeline-step">
                    <div class="step-circle" id="step-call">
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                            <path d="M3 2.5C3 2.5 4.5 2 5 3.5L6 6L4.5 7.5C5.5 9.5 7 11 9 12L10.5 10.5L13 11.5C14.5 12 14 13.5 14 13.5C13 15 10 15 7.5 12.5C5 10 4 7 2.5 3.5C2 3 3 2.5 3 2.5Z" stroke="currentColor" stroke-width="1.3" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </div>
                    <span class="step-label">Call</span>
                </div>
                <div class="pipeline-connector"></div>
                <div class="pipeline-step">
                    <div class="step-circle" id="step-learn">
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                            <path d="M8 2L2 5.5L8 9L14 5.5L8 2Z" stroke="currentColor" stroke-width="1.5" stroke-linejoin="round"/>
                            <path d="M2 8.5L8 12L14 8.5" stroke="currentColor" stroke-width="1.5" stroke-linejoin="round"/>
                        </svg>
                    </div>
                    <span class="step-label">Learn</span>
                </div>
                <div class="pipeline-connector"></div>
                <div class="pipeline-step">
                    <div class="step-circle" id="step-deploy">
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                            <path d="M8 2v8M5 7l3 3 3-3" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M2 11v2h12v-2" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </div>
                    <span class="step-label">Deploy</span>
                </div>
            </div>
        </div>

        <!-- Main Content: 3-column layout -->
        <div class="main-content">
            <!-- Phase 1: Novice -->
            <div class="phase-card" id="phase-1">
                <div class="phase-header">
                    <div class="phase-title-row">
                        <span class="phase-badge phase-badge-novice">Phase 1</span>
                        <span class="phase-title">Novice</span>
                    </div>
                    <span class="phase-client">Acme Corp</span>
                </div>
                <div class="phase-stats">
                    <div class="stat">
                        <span class="stat-value calls-good" id="phase-1-calls">0</span>
                        <span class="stat-label">Phone Calls</span>
                    </div>
                    <div class="stat">
                        <span class="stat-value" id="phase-1-memory">0</span>
                        <span class="stat-label">Memory Hits</span>
                    </div>
                </div>
                <div class="mapping-header">
                    <span>Source</span><span></span><span>Target</span><span>Via</span>
                </div>
                <div class="mapping-table" id="phase-1-mappings"></div>
                <div class="phase-log" id="phase-1-log"></div>
            </div>

            <!-- Center: Tabbed Panel -->
            <div class="center-panel">
                <!-- Tab Bar -->
                <div class="center-tabs">
                    <button class="center-tab" id="tab-setup" onclick="switchTab('setup')">
                        <svg width="14" height="14" viewBox="0 0 14 14" fill="none">
                            <path d="M5.5 1.5h3L9 3.5l1.5.9 2-.5.75 1.3-1.25 1.5v1.6l1.25 1.5-.75 1.3-2-.5L9 10.5l-.5 2h-3l-.5-2-1.5-.9-2 .5-.75-1.3L2 7.8V6.2L.75 4.7l.75-1.3 2 .5L5 3l.5-1.5Z" stroke="currentColor" stroke-width="1" fill="none"/>
                            <circle cx="7" cy="7" r="1.5" stroke="currentColor" stroke-width="1" fill="none"/>
                        </svg>
                        Setup
                    </button>
                    <button class="center-tab active" id="tab-live" onclick="switchTab('live')">
                        <svg width="14" height="14" viewBox="0 0 14 14" fill="none">
                            <circle cx="7" cy="7" r="5.5" stroke="currentColor" stroke-width="1.3"/>
                            <circle cx="7" cy="7" r="2" fill="currentColor"/>
                        </svg>
                        Live
                    </button>
                    <button class="center-tab" id="tab-results" onclick="switchTab('results')">
                        <svg width="14" height="14" viewBox="0 0 14 14" fill="none">
                            <path d="M2 3h10M2 7h7M2 11h8" stroke="currentColor" stroke-width="1.3" stroke-linecap="round"/>
                        </svg>
                        Results
                    </button>
                </div>

                <!-- Setup Tab Content -->
                <div class="tab-content" id="tab-content-setup">
                    <div class="setup-tab-inner">
                        <div class="setup-section">
                            <div class="setup-section-title">Target Fields</div>
                            <div class="field-list" id="field-list">
                                <!-- Populated by JS on load -->
                            </div>
                            <button class="btn btn-add-field" onclick="addField()">
                                <svg width="12" height="12" viewBox="0 0 12 12" fill="none">
                                    <path d="M6 1v10M1 6h10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                                </svg>
                                Add Field
                            </button>
                        </div>
                        <div class="setup-section">
                            <div class="setup-section-title">Client Portals</div>
                            <div class="setup-clients">
                                <div class="setup-client-card">
                                    <div class="setup-client-label">
                                        <span class="phase-badge phase-badge-novice">Phase 1</span>
                                        Client 1 &mdash; Novice
                                    </div>
                                    <label class="setup-input-label">Portal URL
                                        <input type="text" class="setup-input" id="client-1-url" value="" placeholder="http://localhost:5001/portal/acme">
                                    </label>
                                    <div class="setup-input-row">
                                        <label class="setup-input-label">Username
                                            <input type="text" class="setup-input" id="client-1-user" value="admin">
                                        </label>
                                        <label class="setup-input-label">Password
                                            <input type="text" class="setup-input" id="client-1-pass" value="admin123">
                                        </label>
                                    </div>
                                </div>
                                <div class="setup-client-card">
                                    <div class="setup-client-label">
                                        <span class="phase-badge phase-badge-expert">Phase 2</span>
                                        Client 2 &mdash; Expert
                                    </div>
                                    <label class="setup-input-label">Portal URL
                                        <input type="text" class="setup-input" id="client-2-url" value="" placeholder="http://localhost:5001/portal/globex">
                                    </label>
                                    <div class="setup-input-row">
                                        <label class="setup-input-label">Username
                                            <input type="text" class="setup-input" id="client-2-user" value="admin">
                                        </label>
                                        <label class="setup-input-label">Password
                                            <input type="text" class="setup-input" id="client-2-pass" value="admin123">
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Live Tab Content -->
                <div class="tab-content active" id="tab-content-live">
                    <!-- Browser View -->
                    <div class="browser-panel" id="browser-panel">
                        <div class="browser-chrome">
                            <div class="browser-dots">
                                <span class="dot dot-red"></span>
                                <span class="dot dot-yellow"></span>
                                <span class="dot dot-green"></span>
                            </div>
                            <div class="browser-url" id="browser-url">about:blank</div>
                        </div>
                        <div class="browser-viewport">
                            <iframe id="browser-iframe" src="about:blank"></iframe>
                            <div class="browser-overlay" id="browser-overlay">
                                <svg class="browser-idle-icon" width="40" height="40" viewBox="0 0 40 40" fill="none">
                                    <circle cx="20" cy="20" r="18" stroke="#CBD5E1" stroke-width="2"/>
                                    <path d="M20 2C20 2 28 10 28 20C28 30 20 38 20 38" stroke="#CBD5E1" stroke-width="1.5"/>
                                    <path d="M20 2C20 2 12 10 12 20C12 30 20 38 20 38" stroke="#CBD5E1" stroke-width="1.5"/>
                                    <path d="M3 15h34M3 25h34" stroke="#CBD5E1" stroke-width="1.5"/>
                                </svg>
                                <span>AGI Browser — Idle</span>
                            </div>
                            <div class="browser-action" id="browser-action"></div>
                        </div>
                    </div>

                    <!-- Memory Bank -->
                    <div class="memory-panel">
                        <div class="memory-header">
                            <div class="memory-title-row">
                                <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                                    <rect x="2" y="2" width="12" height="12" rx="2" stroke="#7C3AED" stroke-width="1.5"/>
                                    <path d="M5 6h6M5 8h4M5 10h5" stroke="#7C3AED" stroke-width="1.2" stroke-linecap="round"/>
                                </svg>
                                <span class="memory-title">Memory Bank</span>
                            </div>
                            <span class="memory-count" id="memory-count">0 mappings</span>
                        </div>
                        <div class="memory-items" id="memory-items">
                            <div class="memory-empty" id="memory-empty">No mappings learned yet</div>
                        </div>
                    </div>
                </div>

                <!-- Results Tab Content -->
                <div class="tab-content" id="tab-content-results">
                    <div class="results-empty" id="results-empty">
                        <svg width="48" height="48" viewBox="0 0 48 48" fill="none">
                            <rect x="6" y="6" width="36" height="36" rx="6" stroke="#CBD5E1" stroke-width="2"/>
                            <path d="M16 20h16M16 26h12M16 32h14" stroke="#CBD5E1" stroke-width="1.5" stroke-linecap="round"/>
                        </svg>
                        <span>Run the demo to see results</span>
                    </div>
                    <div class="results-content" id="results-content" style="display:none"></div>
                </div>
            </div>

            <!-- Phase 2: Expert -->
            <div class="phase-card" id="phase-2">
                <div class="phase-header">
                    <div class="phase-title-row">
                        <span class="phase-badge phase-badge-expert">Phase 2</span>
                        <span class="phase-title">Expert</span>
                    </div>
                    <span class="phase-client">Globex Inc</span>
                </div>
                <div class="phase-stats">
                    <div class="stat">
                        <span class="stat-value calls-good" id="phase-2-calls">0</span>
                        <span class="stat-label">Phone Calls</span>
                    </div>
                    <div class="stat">
                        <span class="stat-value" id="phase-2-memory">0</span>
                        <span class="stat-label">Memory Hits</span>
                    </div>
                </div>
                <div class="mapping-header">
                    <span>Source</span><span></span><span>Target</span><span>Via</span>
                </div>
                <div class="mapping-table" id="phase-2-mappings"></div>
                <div class="phase-log" id="phase-2-log"></div>
            </div>
        </div>
    </div>

    <script src="/static/dashboard.js"></script>
</body>
</html>
